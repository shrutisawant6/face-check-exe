function startVideo(){navigator.getUserMedia({video:{}},n=>video.srcObject=n,n=>console.error(n))}function SetCanvas(n){canvas!=undefined&&document.body.removeChild(canvas);canvas=faceapi.createCanvasFromMedia(video);document.body.appendChild(canvas);var t=video.width;n!==""&&isMobile()&&isPortrait(n)&&(t=video.width-(video.width-video.videoWidth));const i={width:t,height:video.height};return faceapi.matchDimensions(canvas,i),{displaySize:i,canvas:canvas}}function isMobile(){return/Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function isPortrait(n){return/portrait/i.test(n)}const video=document.getElementById("video");Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri("/models"),faceapi.nets.faceLandmark68Net.loadFromUri("/models"),faceapi.nets.faceRecognitionNet.loadFromUri("/models"),faceapi.nets.faceExpressionNet.loadFromUri("/models"),faceapi.nets.ageGenderNet.loadFromUri("/models"),]).then(startVideo);window.addEventListener("orientationchange",function(){SetCanvas(screen.orientation.type)});video.addEventListener("play",()=>{setInterval(async()=>{var n=SetCanvas("portrait");const i=await faceapi.detectAllFaces(video,new faceapi.TinyFaceDetectorOptions).withFaceLandmarks().withFaceExpressions().withAgeAndGender(),t=faceapi.resizeResults(i,n.displaySize);canvas.getContext("2d").clearRect(0,0,n.canvas.width,n.canvas.height);faceapi.draw.drawDetections(n.canvas,t);faceapi.draw.drawFaceLandmarks(n.canvas,t);faceapi.draw.drawFaceExpressions(n.canvas,t);t.forEach(t=>{const r=t.detection.box;var i=Math.round(t.age),u=i>1?" years old ":" year old ";const f=new faceapi.draw.DrawBox(r,{label:i+u+t.gender});f.draw(n.canvas)})},1e3)});var canvas;